import{_ as i,o as a,c as n,ak as l,bO as p,bP as h,bQ as e,bR as t,bS as k,bT as r,bU as d,bV as E,bW as g}from"./chunks/framework.CGzjHEBf.js";const _=JSON.parse('{"title":"4.3 æ¡ˆä¾‹äºŒï¼šMRI Kç©ºé—´æˆåƒä¸é‡å»ºå®éªŒ","description":"å®Œæ•´çš„MRI Kç©ºé—´æˆåƒæµç¨‹ï¼ŒåŒ…æ‹¬æ¬ é‡‡æ ·ç­–ç•¥ã€é‡å»ºç®—æ³•ä¸è´¨é‡è¯„ä¼°","frontmatter":{"title":"4.3 æ¡ˆä¾‹äºŒï¼šMRI Kç©ºé—´æˆåƒä¸é‡å»ºå®éªŒ","description":"å®Œæ•´çš„MRI Kç©ºé—´æˆåƒæµç¨‹ï¼ŒåŒ…æ‹¬æ¬ é‡‡æ ·ç­–ç•¥ã€é‡å»ºç®—æ³•ä¸è´¨é‡è¯„ä¼°"},"headers":[],"relativePath":"guide/ch04/03-mri-case.md","filePath":"zh/guide/ch04/03-mri-case.md"}'),c={name:"guide/ch04/03-mri-case.md"};function y(b,s,o,u,F,m){return a(),n("div",null,[...s[0]||(s[0]=[l(`<h1 id="_4-3-æ¡ˆä¾‹äºŒ-mri-kç©ºé—´æˆåƒä¸é‡å»ºå®éªŒ" tabindex="-1">4.3 æ¡ˆä¾‹äºŒï¼šMRI Kç©ºé—´æˆåƒä¸é‡å»ºå®éªŒ <a class="header-anchor" href="#_4-3-æ¡ˆä¾‹äºŒ-mri-kç©ºé—´æˆåƒä¸é‡å»ºå®éªŒ" aria-label="Permalink to â€œ4.3 æ¡ˆä¾‹äºŒï¼šMRI Kç©ºé—´æˆåƒä¸é‡å»ºå®éªŒâ€">â€‹</a></h1><p>MRI çš„åŸå§‹æ•°æ®åœ¨ <strong>Kç©ºé—´</strong>ï¼ˆé¢‘ç‡åŸŸï¼‰ã€‚æœ¬èŠ‚é€šè¿‡å®Œæ•´çš„å®éªŒæµç¨‹ï¼Œç†è§£å›¾åƒä¸Kç©ºé—´çš„äºŒç»´FFTå…³ç³»ï¼Œæ¢ç´¢ä¸åŒæ¬ é‡‡æ ·ç­–ç•¥å¯¹é‡å»ºè´¨é‡çš„å½±å“ï¼Œå¹¶å®ç°å¤šç§é‡å»ºç®—æ³•è¿›è¡Œå¯¹æ¯”åˆ†æã€‚</p><hr><h2 id="_1-kç©ºé—´åŸºç¡€" tabindex="-1">1. Kç©ºé—´åŸºç¡€ <a class="header-anchor" href="#_1-kç©ºé—´åŸºç¡€" aria-label="Permalink to â€œ1. Kç©ºé—´åŸºç¡€â€">â€‹</a></h2><h3 id="_1-1-å›¾åƒåˆ°kç©ºé—´çš„å˜æ¢" tabindex="-1">1.1 å›¾åƒåˆ°Kç©ºé—´çš„å˜æ¢ <a class="header-anchor" href="#_1-1-å›¾åƒåˆ°kç©ºé—´çš„å˜æ¢" aria-label="Permalink to â€œ1.1 å›¾åƒåˆ°Kç©ºé—´çš„å˜æ¢â€">â€‹</a></h3><p>MRIä¿¡å·åœ¨Kç©ºé—´é‡‡é›†ï¼Œé€šè¿‡äºŒç»´å‚…é‡Œå¶å˜æ¢ï¼ˆFFTï¼‰è½¬æ¢åˆ°å›¾åƒåŸŸï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> matplotlib.pyplot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> plt</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> skimage.data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> shepp_logan_phantom</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> skimage.transform </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> resize</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”Ÿæˆæµ‹è¯•å›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> resize(shepp_logan_phantom(), (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">anti_aliasing</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å›¾åƒ â†’ Kç©ºé—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">k_space </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.fft.fftshift(np.fft.fft2(img))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">magnitude </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.log1p(np.abs(k_space))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.angle(k_space)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><figure><img src="`+p+`" alt="Kç©ºé—´åŸºç¡€" tabindex="0"><figcaption>Kç©ºé—´åŸºç¡€</figcaption></figure><p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼š</p><ul><li>Kç©ºé—´ä¸­å¿ƒå¯¹åº”å›¾åƒçš„ä½é¢‘ä¿¡æ¯ï¼ˆå¯¹æ¯”åº¦ï¼‰</li><li>Kç©ºé—´è¾¹ç¼˜å¯¹åº”å›¾åƒçš„é«˜é¢‘ä¿¡æ¯ï¼ˆç»†èŠ‚/è¾¹ç¼˜ï¼‰</li><li>ç›¸ä½ä¿¡æ¯å¯¹å›¾åƒé‡å»ºè‡³å…³é‡è¦</li></ul><h3 id="_1-2-å…¨é‡‡æ ·é‡å»º" tabindex="-1">1.2 å…¨é‡‡æ ·é‡å»º <a class="header-anchor" href="#_1-2-å…¨é‡‡æ ·é‡å»º" aria-label="Permalink to â€œ1.2 å…¨é‡‡æ ·é‡å»ºâ€">â€‹</a></h3><p>ä»å®Œæ•´Kç©ºé—´æ•°æ®é€šè¿‡é€†å‚…é‡Œå¶å˜æ¢ï¼ˆIFFTï¼‰é‡å»ºå›¾åƒï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Kç©ºé—´ â†’ å›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">recon_full </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.real(np.fft.ifft2(np.fft.ifftshift(k_space)))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><figure><img src="`+h+`" alt="å…¨é‡‡æ ·é‡å»º" tabindex="0"><figcaption>å…¨é‡‡æ ·é‡å»º</figcaption></figure><p>å…¨é‡‡æ ·é‡å»ºèƒ½å¤Ÿå®Œç¾æ¢å¤åŸå§‹å›¾åƒï¼ˆæ•°å€¼è¯¯å·® &lt; 1e-10ï¼‰ã€‚</p><hr><h2 id="_2-æ¬ é‡‡æ ·ç­–ç•¥" tabindex="-1">2. æ¬ é‡‡æ ·ç­–ç•¥ <a class="header-anchor" href="#_2-æ¬ é‡‡æ ·ç­–ç•¥" aria-label="Permalink to â€œ2. æ¬ é‡‡æ ·ç­–ç•¥â€">â€‹</a></h2><p>ä¸ºåŠ é€ŸMRIæ‰«æï¼Œå¸¸é‡‡ç”¨æ¬ é‡‡æ ·ç­–ç•¥ã€‚ä»¥ä¸‹æ˜¯ä¸‰ç§å…¸å‹æ–¹æ³•ï¼š</p><h3 id="_2-1-çº¿é‡‡æ ·-line-undersampling" tabindex="-1">2.1 çº¿é‡‡æ ·ï¼ˆLine Undersamplingï¼‰ <a class="header-anchor" href="#_2-1-çº¿é‡‡æ ·-line-undersampling" aria-label="Permalink to â€œ2.1 çº¿é‡‡æ ·ï¼ˆLine Undersamplingï¼‰â€">â€‹</a></h3><p>æ¯éš”Nè¡Œä¿ç•™ä¸€è¡Œï¼Œå®ç°ç®€å•ä½†ä¼šå¼•å…¥æ··å ä¼ªå½±ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_line_undersampling_mask</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size, factor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;çº¿é‡‡æ ·æ©æ¨¡&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.zeros((size, size), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dtype</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask[::factor, :] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mask</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-2-ä¸­å¿ƒä¼˜å…ˆé‡‡æ ·-center-priority" tabindex="-1">2.2 ä¸­å¿ƒä¼˜å…ˆé‡‡æ ·ï¼ˆCenter-Priorityï¼‰ <a class="header-anchor" href="#_2-2-ä¸­å¿ƒä¼˜å…ˆé‡‡æ ·-center-priority" aria-label="Permalink to â€œ2.2 ä¸­å¿ƒä¼˜å…ˆé‡‡æ ·ï¼ˆCenter-Priorityï¼‰â€">â€‹</a></h3><p>ä¿ç•™Kç©ºé—´ä¸­å¿ƒåŒºåŸŸï¼ˆä½é¢‘ä¿¡æ¯ï¼‰ï¼Œå¯¹è¾¹ç¼˜è¿›è¡Œæ¬ é‡‡æ ·ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_center_priority_mask</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size, center_lines</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, outer_factor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;ä¸­å¿ƒä¼˜å…ˆé‡‡æ ·æ©æ¨¡&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.zeros((size, size), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dtype</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    center_start </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> center_lines) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">//</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask[center_start:center_start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">center_lines, :] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # è¾¹ç¼˜æ¬ é‡‡æ ·</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    outer_indices </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.arange(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, center_start, outer_factor)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask[outer_indices, :] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask[size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:center_start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">center_lines:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">outer_factor, :] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mask</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_2-3-å¾„å‘é‡‡æ ·-radial-sampling" tabindex="-1">2.3 å¾„å‘é‡‡æ ·ï¼ˆRadial Samplingï¼‰ <a class="header-anchor" href="#_2-3-å¾„å‘é‡‡æ ·-radial-sampling" aria-label="Permalink to â€œ2.3 å¾„å‘é‡‡æ ·ï¼ˆRadial Samplingï¼‰â€">â€‹</a></h3><p>æ²¿å¾„å‘æ–¹å‘é‡‡æ ·ï¼Œå¯¹è¿åŠ¨ä¸æ•æ„Ÿï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_radial_mask</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size, n_spokes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;å¾„å‘é‡‡æ ·æ©æ¨¡&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.zeros((size, size), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dtype</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    center </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">//</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    angles </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.linspace(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, np.pi, n_spokes, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">endpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> angle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> angles:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">//</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(center </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.cos(angle))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(center </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.sin(angle))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> size:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                mask[y, x] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mask</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><figure><img src="`+e+'" alt="é‡‡æ ·æ©æ¨¡å¯¹æ¯”" tabindex="0"><figcaption>é‡‡æ ·æ©æ¨¡å¯¹æ¯”</figcaption></figure><hr><h2 id="_3-æ¬ é‡‡æ ·ä¼ªå½±åˆ†æ" tabindex="-1">3. æ¬ é‡‡æ ·ä¼ªå½±åˆ†æ <a class="header-anchor" href="#_3-æ¬ é‡‡æ ·ä¼ªå½±åˆ†æ" aria-label="Permalink to â€œ3. æ¬ é‡‡æ ·ä¼ªå½±åˆ†æâ€">â€‹</a></h2><p>ä¸åŒæ¬ é‡‡æ ·ç­–ç•¥ä¼šåœ¨é‡å»ºå›¾åƒä¸­å¼•å…¥ä¸åŒç±»å‹çš„ä¼ªå½±ï¼š</p><figure><img src="'+t+`" alt="æ¬ é‡‡æ ·ä¼ªå½±" tabindex="0"><figcaption>æ¬ é‡‡æ ·ä¼ªå½±</figcaption></figure><p><strong>ä¼ªå½±ç‰¹å¾</strong>ï¼š</p><ul><li><strong>çº¿é‡‡æ ·</strong>ï¼šæ²¿ç›¸ä½ç¼–ç æ–¹å‘çš„æ··å ï¼ˆAliasingï¼‰</li><li><strong>ä¸­å¿ƒä¼˜å…ˆ</strong>ï¼šç›¸å¯¹è¾ƒå°‘çš„ä¼ªå½±ï¼Œä½†é«˜é¢‘ä¿¡æ¯ä¸¢å¤±</li><li><strong>å¾„å‘é‡‡æ ·</strong>ï¼šæ˜ŸçŠ¶ä¼ªå½±ï¼ˆStreaking Artifactsï¼‰</li></ul><hr><h2 id="_4-é‡å»ºç®—æ³•" tabindex="-1">4. é‡å»ºç®—æ³• <a class="header-anchor" href="#_4-é‡å»ºç®—æ³•" aria-label="Permalink to â€œ4. é‡å»ºç®—æ³•â€">â€‹</a></h2><h3 id="_4-1-ç›´æ¥iffté‡å»º" tabindex="-1">4.1 ç›´æ¥IFFTé‡å»º <a class="header-anchor" href="#_4-1-ç›´æ¥iffté‡å»º" aria-label="Permalink to â€œ4.1 ç›´æ¥IFFTé‡å»ºâ€">â€‹</a></h3><p>æœ€ç®€å•çš„é‡å»ºæ–¹æ³•ï¼Œä½†æ¬ é‡‡æ ·æ—¶è´¨é‡è¾ƒå·®ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åº”ç”¨é‡‡æ ·æ©æ¨¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">k_undersampled </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k_space </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mask</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç›´æ¥IFFTé‡å»º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">recon_direct </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.real(np.fft.ifft2(np.fft.ifftshift(k_undersampled)))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_4-2-é›¶å¡«å……é‡å»º" tabindex="-1">4.2 é›¶å¡«å……é‡å»º <a class="header-anchor" href="#_4-2-é›¶å¡«å……é‡å»º" aria-label="Permalink to â€œ4.2 é›¶å¡«å……é‡å»ºâ€">â€‹</a></h3><p>å¯¹æœªé‡‡æ ·ç‚¹è¿›è¡Œé›¶å¡«å……ï¼Œå‡å°‘æ··å ä½†ä¼šæ¨¡ç³Šï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¡ç®—é‡‡æ ·å¯†åº¦è¡¥å¿</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sampling_density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.sum(mask) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mask.size</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é›¶å¡«å……é‡å»º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">k_zero_filled </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k_undersampled.copy()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">k_zero_filled[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mask] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">recon_zero </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.real(np.fft.ifft2(np.fft.ifftshift(k_zero_filled))) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sampling_density</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_4-3-pocsè¿­ä»£é‡å»º-å‹ç¼©æ„ŸçŸ¥" tabindex="-1">4.3 POCSè¿­ä»£é‡å»ºï¼ˆå‹ç¼©æ„ŸçŸ¥ï¼‰ <a class="header-anchor" href="#_4-3-pocsè¿­ä»£é‡å»º-å‹ç¼©æ„ŸçŸ¥" aria-label="Permalink to â€œ4.3 POCSè¿­ä»£é‡å»ºï¼ˆå‹ç¼©æ„ŸçŸ¥ï¼‰â€">â€‹</a></h3><p>åˆ©ç”¨å›¾åƒç¨€ç–æ€§è¿›è¡Œè¿­ä»£é‡å»ºï¼Œæ˜¾è‘—å‡å°‘ä¼ªå½±ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pocs_reconstruction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(k_undersampled, mask, n_iterations</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, lambda_reg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    POCS (Projection Onto Convex Sets) è¿­ä»£é‡å»º</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    å‚æ•°:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        k_undersampled: æ¬ é‡‡æ ·Kç©ºé—´æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        mask: é‡‡æ ·æ©æ¨¡</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        n_iterations: è¿­ä»£æ¬¡æ•°</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        lambda_reg: æ­£åˆ™åŒ–å‚æ•°ï¼ˆè½¯é˜ˆå€¼ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # åˆå§‹ä¼°è®¡ï¼šé›¶å¡«å……é‡å»º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.real(np.fft.ifft2(np.fft.ifftshift(k_undersampled)))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n_iterations):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # æ­¥éª¤1: å˜æ¢åˆ°Kç©ºé—´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.fft.fftshift(np.fft.fft2(x))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # æ­¥éª¤2: æ•°æ®ä¸€è‡´æ€§æŠ•å½±ï¼ˆä¿æŒé‡‡æ ·ç‚¹ä¸å˜ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k_undersampled</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # æ­¥éª¤3: å˜æ¢å›å›¾åƒåŸŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.real(np.fft.ifft2(np.fft.ifftshift(k)))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # æ­¥éª¤4: ç¨€ç–æ€§çº¦æŸï¼ˆè½¯é˜ˆå€¼ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.sign(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.maximum(np.abs(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lambda_reg, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><figure><img src="`+k+`" alt="POCSé‡å»º" tabindex="0"><figcaption>POCSé‡å»º</figcaption></figure><p><strong>POCSç®—æ³•ç‰¹ç‚¹</strong>ï¼š</p><ul><li>è¿­ä»£è¿‡ç¨‹ä¸­é€æ­¥å‡å°‘ä¼ªå½±</li><li>æ•°æ®ä¸€è‡´æ€§çº¦æŸç¡®ä¿é‡‡æ ·ç‚¹å‡†ç¡®</li><li>ç¨€ç–æ€§çº¦æŸåˆ©ç”¨å›¾åƒå…ˆéªŒä¿¡æ¯</li></ul><hr><h2 id="_5-kç©ºé—´æ»¤æ³¢" tabindex="-1">5. Kç©ºé—´æ»¤æ³¢ <a class="header-anchor" href="#_5-kç©ºé—´æ»¤æ³¢" aria-label="Permalink to â€œ5. Kç©ºé—´æ»¤æ³¢â€">â€‹</a></h2><p>åœ¨Kç©ºé—´åº”ç”¨æ»¤æ³¢å™¨å¯ä»¥æ§åˆ¶å›¾åƒç‰¹æ€§ï¼š</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½é€šæ»¤æ³¢ï¼ˆå¹³æ»‘ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_lowpass_filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size, cutoff_ratio</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.linspace(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, size)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.linspace(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, size)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    X, Y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.meshgrid(x, y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    R </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.sqrt(X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> R </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cutoff_ratio</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åº”ç”¨æ»¤æ³¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lowpass_filter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> create_lowpass_filter(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">k_filtered </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k_space </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lowpass_filter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">img_lowpass </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.real(np.fft.ifft2(np.fft.ifftshift(k_filtered)))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><figure><img src="`+r+`" alt="Kç©ºé—´æ»¤æ³¢" tabindex="0"><figcaption>Kç©ºé—´æ»¤æ³¢</figcaption></figure><hr><h2 id="_6-åå¤„ç†" tabindex="-1">6. åå¤„ç† <a class="header-anchor" href="#_6-åå¤„ç†" aria-label="Permalink to â€œ6. åå¤„ç†â€">â€‹</a></h2><h3 id="_6-1-é«˜æ–¯æ»¤æ³¢é™å™ª" tabindex="-1">6.1 é«˜æ–¯æ»¤æ³¢é™å™ª <a class="header-anchor" href="#_6-1-é«˜æ–¯æ»¤æ³¢é™å™ª" aria-label="Permalink to â€œ6.1 é«˜æ–¯æ»¤æ³¢é™å™ªâ€">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scipy.ndimage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gaussian_filter</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">recon_denoised </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gaussian_filter(recon_pocs, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sigma</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_6-2-éé”åŒ–æ©æ¨¡è¾¹ç¼˜å¢å¼º" tabindex="-1">6.2 éé”åŒ–æ©æ¨¡è¾¹ç¼˜å¢å¼º <a class="header-anchor" href="#_6-2-éé”åŒ–æ©æ¨¡è¾¹ç¼˜å¢å¼º" aria-label="Permalink to â€œ6.2 éé”åŒ–æ©æ¨¡è¾¹ç¼˜å¢å¼ºâ€">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é«˜æ–¯æ¨¡ç³Š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">blurred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gaussian_filter(recon_denoised, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sigma</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># éé”åŒ–æ©æ¨¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">unsharp_mask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> recon_denoised </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> blurred</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">recon_enhanced </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> recon_denoised </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> unsharp_mask</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><figure><img src="`+d+'" alt="åå¤„ç†æ•ˆæœ" tabindex="0"><figcaption>åå¤„ç†æ•ˆæœ</figcaption></figure><hr><h2 id="_7-é‡‡æ ·ç‡åˆ†æ" tabindex="-1">7. é‡‡æ ·ç‡åˆ†æ <a class="header-anchor" href="#_7-é‡‡æ ·ç‡åˆ†æ" aria-label="Permalink to â€œ7. é‡‡æ ·ç‡åˆ†æâ€">â€‹</a></h2><p>ä¸åŒæ¬ é‡‡æ ·ç‡å¯¹é‡å»ºè´¨é‡çš„å½±å“ï¼š</p><figure><img src="'+E+'" alt="é‡‡æ ·ç‡åˆ†æ" tabindex="0"><figcaption>é‡‡æ ·ç‡åˆ†æ</figcaption></figure><p><strong>å…³é”®å‘ç°</strong>ï¼š</p><ul><li>é‡‡æ ·ç‡ &gt; 25%ï¼šç›´æ¥IFFTå¯è·å¾—å¯æ¥å—è´¨é‡</li><li>é‡‡æ ·ç‡ 10-25%ï¼šéœ€è¦POCSç­‰è¿­ä»£ç®—æ³•</li><li>é‡‡æ ·ç‡ &lt; 10%ï¼šé‡å»ºè´¨é‡æ˜¾è‘—ä¸‹é™</li></ul><hr><h2 id="_8-æ–¹æ³•å¯¹æ¯”ä¸è´¨é‡è¯„ä¼°" tabindex="-1">8. æ–¹æ³•å¯¹æ¯”ä¸è´¨é‡è¯„ä¼° <a class="header-anchor" href="#_8-æ–¹æ³•å¯¹æ¯”ä¸è´¨é‡è¯„ä¼°" aria-label="Permalink to â€œ8. æ–¹æ³•å¯¹æ¯”ä¸è´¨é‡è¯„ä¼°â€">â€‹</a></h2><h3 id="_8-1-é‡å»ºæ–¹æ³•å¯¹æ¯”" tabindex="-1">8.1 é‡å»ºæ–¹æ³•å¯¹æ¯” <a class="header-anchor" href="#_8-1-é‡å»ºæ–¹æ³•å¯¹æ¯”" aria-label="Permalink to â€œ8.1 é‡å»ºæ–¹æ³•å¯¹æ¯”â€">â€‹</a></h3><figure><img src="'+g+'" alt="æ–¹æ³•å¯¹æ¯”" tabindex="0"><figcaption>æ–¹æ³•å¯¹æ¯”</figcaption></figure><h3 id="_8-2-å®šé‡è´¨é‡æŒ‡æ ‡" tabindex="-1">8.2 å®šé‡è´¨é‡æŒ‡æ ‡ <a class="header-anchor" href="#_8-2-å®šé‡è´¨é‡æŒ‡æ ‡" aria-label="Permalink to â€œ8.2 å®šé‡è´¨é‡æŒ‡æ ‡â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–¹æ³•</th><th>PSNR (dB)</th><th>SSIM</th><th>NMSE (%)</th></tr></thead><tbody><tr><td>ç›´æ¥IFFT</td><td>16.8</td><td>0.42</td><td>45.2</td></tr><tr><td>é›¶å¡«å……</td><td>18.5</td><td>0.51</td><td>38.7</td></tr><tr><td>POCS (50æ¬¡)</td><td>28.3</td><td>0.89</td><td>12.1</td></tr><tr><td>POCS + åå¤„ç†</td><td>29.7</td><td>0.92</td><td>10.3</td></tr></tbody></table><p><strong>æŒ‡æ ‡è¯´æ˜</strong>ï¼š</p><ul><li><strong>PSNR</strong>ï¼ˆå³°å€¼ä¿¡å™ªæ¯”ï¼‰ï¼šè¶Šé«˜è¶Šå¥½ï¼Œ&gt;30dBä¸ºä¼˜ç§€</li><li><strong>SSIM</strong>ï¼ˆç»“æ„ç›¸ä¼¼æ€§ï¼‰ï¼š0-1èŒƒå›´ï¼Œè¶Šæ¥è¿‘1è¶Šå¥½</li><li><strong>NMSE</strong>ï¼ˆå½’ä¸€åŒ–å‡æ–¹è¯¯å·®ï¼‰ï¼šè¶Šä½è¶Šå¥½</li></ul><hr><h2 id="_9-å®Œæ•´ä»£ç " tabindex="-1">9. å®Œæ•´ä»£ç  <a class="header-anchor" href="#_9-å®Œæ•´ä»£ç " aria-label="Permalink to â€œ9. å®Œæ•´ä»£ç â€">â€‹</a></h2><p>å®Œæ•´çš„MRIé‡å»ºæµç¨‹ä»£ç å·²æ•´ç†ä¸ºJupyter Notebookï¼š</p><p>ğŸ““ <a href="https://github.com/1985312383/med-imaging-primer/tree/main/src/ch04/mri_reconstruction_pipeline.ipynb" target="_blank" rel="noreferrer"><code>mri_reconstruction_pipeline.ipynb</code></a></p><p>åŒ…å«ï¼š</p><ul><li>æ‰€æœ‰é‡å»ºç®—æ³•çš„å®Œæ•´å®ç°</li><li>å‚æ•°è°ƒä¼˜å»ºè®®</li><li>å¯è§†åŒ–è¾“å‡º</li><li>è´¨é‡è¯„ä¼°å·¥å…·</li></ul><hr><h2 id="_10-å°ç»“" tabindex="-1">10. å°ç»“ <a class="header-anchor" href="#_10-å°ç»“" aria-label="Permalink to â€œ10. å°ç»“â€">â€‹</a></h2><p>æœ¬æ¡ˆä¾‹å±•ç¤ºäº†å®Œæ•´çš„MRI Kç©ºé—´æˆåƒä¸é‡å»ºæµç¨‹ï¼š</p><ol><li><strong>Kç©ºé—´åŸºç¡€</strong>ï¼šç†è§£é¢‘ç‡åŸŸä¸å›¾åƒåŸŸçš„å…³ç³»</li><li><strong>æ¬ é‡‡æ ·ç­–ç•¥</strong>ï¼šçº¿é‡‡æ ·ã€ä¸­å¿ƒä¼˜å…ˆã€å¾„å‘é‡‡æ ·</li><li><strong>é‡å»ºç®—æ³•</strong>ï¼šç›´æ¥IFFTã€é›¶å¡«å……ã€POCSè¿­ä»£</li><li><strong>åå¤„ç†</strong>ï¼šé™å™ªä¸è¾¹ç¼˜å¢å¼º</li><li><strong>è´¨é‡è¯„ä¼°</strong>ï¼šPSNRã€SSIMã€NMSEæŒ‡æ ‡</li></ol><p><strong>æœ€ä½³å®è·µå»ºè®®</strong>ï¼š</p><ul><li>é‡‡æ ·ç‡ â‰¥ 25%ï¼šä½¿ç”¨ç›´æ¥IFFTæˆ–é›¶å¡«å……</li><li>é‡‡æ ·ç‡ 10-25%ï¼šä½¿ç”¨POCSè¿­ä»£é‡å»º</li><li>é‡‡æ ·ç‡ &lt; 10%ï¼šè€ƒè™‘æ·±åº¦å­¦ä¹ é‡å»ºæ–¹æ³•</li><li>å§‹ç»ˆä¿ç•™Kç©ºé—´ä¸­å¿ƒä½é¢‘ä¿¡æ¯</li></ul><hr><h2 id="å‚è€ƒ" tabindex="-1">å‚è€ƒ <a class="header-anchor" href="#å‚è€ƒ" aria-label="Permalink to â€œå‚è€ƒâ€">â€‹</a></h2><ul><li>é¢„å¤„ç†æ–¹æ³•ï¼š<a href="./../ch02/02-mri-preprocessing.html">2.2 MRIé¢„å¤„ç†</a></li><li>è¿­ä»£é‡å»ºæŠ€æœ¯ï¼š<a href="./../ch03/02-iterative-recon.html">3.2 è¿­ä»£é‡å»º</a></li><li>CTé‡å»ºæ¡ˆä¾‹ï¼š<a href="./02-ct-case.html">4.2 CTé‡å»ºæ¡ˆä¾‹</a></li></ul>',89)])])}const A=i(c,[["render",y]]);export{_ as __pageData,A as default};
