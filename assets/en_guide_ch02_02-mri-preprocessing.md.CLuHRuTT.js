import{_ as r,I as s,o,c as t,ak as l,J as c,j as i,a}from"./chunks/framework.CGzjHEBf.js";const y=JSON.parse('{"title":"2.2 MRI: k-Space Preprocessing","description":"Deeply understand k-space acquisition, noise characteristics, parallel imaging and motion correction in a complete preprocessing workflow","frontmatter":{"title":"2.2 MRI: k-Space Preprocessing","description":"Deeply understand k-space acquisition, noise characteristics, parallel imaging and motion correction in a complete preprocessing workflow"},"headers":[],"relativePath":"en/guide/ch02/02-mri-preprocessing.md","filePath":"en/guide/ch02/02-mri-preprocessing.md"}'),p={name:"en/guide/ch02/02-mri-preprocessing.md"};function d(g,e,m,h,u,f){const n=s("Mermaid");return o(),t("div",null,[e[0]||(e[0]=l('<h1 id="_2-2-mri-k-space-preprocessing" tabindex="-1">2.2 MRI: k-Space Preprocessing <a class="header-anchor" href="#_2-2-mri-k-space-preprocessing" aria-label="Permalink to “2.2 MRI: k-Space Preprocessing”">​</a></h1><blockquote><p>&quot;MRI does not acquire an image directly; it acquires the &#39;music&#39; of the object in the frequency domain. Understanding k-space is learning the language of that music.&quot; — Wisdom of Medical Imaging Signal Processing</p></blockquote><p>When radiologists look at a crisp MR image, few realize how complex the acquisition pipeline behind it is. From the moment the MR signal is captured by the receive coils, the data starts a journey in the frequency domain—from raw sampling in k-space, through noise estimation, preparation for parallel imaging, and motion-related corrections—before an inverse Fourier transform yields the image we see.</p><p>This chapter presents the complete MRI preprocessing workflow. Unlike CT (which focuses on projection-domain corrections), MRI preprocessing centers on the k-space domain. We explain the physical meaning of k-space, its noise statistics, the mechanics of parallel imaging, and how principled preprocessing improves image quality. These topics form the foundation of MRI reconstruction and are key to optimizing diagnostic performance.</p><h2 id="k-space-fundamentals-frequency-domain-representation" tabindex="-1">k-Space Fundamentals (Frequency-Domain Representation) <a class="header-anchor" href="#k-space-fundamentals-frequency-domain-representation" aria-label="Permalink to “k-Space Fundamentals (Frequency-Domain Representation)”">​</a></h2><h3 id="mri-signal-equation-and-fourier-relationship" tabindex="-1">MRI Signal Equation and Fourier Relationship <a class="header-anchor" href="#mri-signal-equation-and-fourier-relationship" aria-label="Permalink to “MRI Signal Equation and Fourier Relationship”">​</a></h3><p>Under a 2D assumption with spatial coordinates (x, y), the received MR signal with gradient encoding can be written as the Fourier transform of the transverse magnetization (M_0(x,y)):</p><p>[ s(\\mathbf{k}) = \\iint M_0(x,y), e^{-i,2\\pi,(\\mathbf{k}\\cdot\\mathbf{r})}, d\\mathbf{r},\\quad \\mathbf{r}=(x,y) ]</p><p>where (\\mathbf{k}=(k_x,k_y)) is determined by gradients and time (frequency encoding and phase encoding). Once (s(k_x,k_y)) is acquired, the image (I(x,y)) is recovered by the inverse Fourier transform (IDFT in practice):</p><p>[ I(x,y) = \\iint s(k_x,k_y), e^{+i,2\\pi,(k_x x + k_y y)}, dk_x, dk_y. ]</p><h3 id="geometric-meaning-and-sampling-trajectories" tabindex="-1">Geometric Meaning and Sampling Trajectories <a class="header-anchor" href="#geometric-meaning-and-sampling-trajectories" aria-label="Permalink to “Geometric Meaning and Sampling Trajectories”">​</a></h3><ul><li>k-space coordinates ((k_x,k_y)) represent spatial frequency content. Low-frequency samples near the center determine overall contrast; high-frequency samples at the periphery govern edges and fine details.</li><li>The sampling interval (\\Delta k) is inversely related to the field of view (FOV); k-space extent determines spatial resolution.</li><li>Common trajectories: Cartesian (row-by-row), radial, spiral, EPI (single-shot or multi-shot). Non-Cartesian sampling requires regridding or NUFFT before reconstruction.</li></ul><h3 id="typical-artifacts-related-to-k-space" tabindex="-1">Typical Artifacts Related to k-Space <a class="header-anchor" href="#typical-artifacts-related-to-k-space" aria-label="Permalink to “Typical Artifacts Related to k-Space”">​</a></h3><ul><li>Undersampling/aliasing (violating Nyquist): fold-over (wrap-around) artifacts.</li><li>Truncation of high-frequency components: edge ringing (Gibbs ringing).</li><li>Gradient delays/nonlinearities, B0/B1 inhomogeneity, eddy currents: k-space distortions causing ghosting and blurring.</li></ul><h2 id="why-k-space-preprocessing-matters-for-ai-and-clinical-imaging" tabindex="-1">Why k-Space Preprocessing Matters (for AI and Clinical Imaging) <a class="header-anchor" href="#why-k-space-preprocessing-matters-for-ai-and-clinical-imaging" aria-label="Permalink to “Why k-Space Preprocessing Matters (for AI and Clinical Imaging)”">​</a></h2><ul><li>Image quality foundations: blur, unclear edges, and artifacts (aliasing, Gibbs) often originate from k-space sampling or inadequate compensation.</li><li>Reconstruction and resampling strategy: understanding trajectories, signal models, and reconstruction is essential when customizing pipelines beyond standard DICOM images.</li><li>Noise and artifact sources: motion, gradient imperfections, coil sensitivity changes manifest as abnormal frequency components; correcting them in k-space improves downstream segmentation/detection.</li><li>AI compatibility: changes in sampling strategies (acceleration, parallel imaging, partial Fourier, non-Cartesian) alter noise textures/structure—account for these differences in training.</li></ul><h2 id="noise-estimation-and-denoising" tabindex="-1">Noise Estimation and Denoising <a class="header-anchor" href="#noise-estimation-and-denoising" aria-label="Permalink to “Noise Estimation and Denoising”">​</a></h2><h3 id="noise-statistics-in-mr-images" tabindex="-1">Noise Statistics in MR Images <a class="header-anchor" href="#noise-statistics-in-mr-images" aria-label="Permalink to “Noise Statistics in MR Images”">​</a></h3><p>Magnitude MR images often exhibit Rician or, for multi-coil combinations, non-central chi (nc-χ) distributed noise. Noise can be spatially non-stationary due to coil sensitivity and parallel imaging reconstruction. Preprocessing operations (filtering, zero-padding, regridding) also alter noise mean and covariance.</p><h3 id="non-local-means-nlm-denoising" tabindex="-1">Non-Local Means (NLM) Denoising <a class="header-anchor" href="#non-local-means-nlm-denoising" aria-label="Permalink to “Non-Local Means (NLM) Denoising”">​</a></h3><p>Core idea: leverage self-similarity of patches across the image, not only local neighborhoods, to preserve edges while suppressing noise. A generic form:</p><p>[ \\tilde I(p) = \\frac{1}{C(p)} \\sum_{q} w(p,q), I(q), \\quad w(p,q) = \\exp!\\Big( - \\frac{|I(\\mathcal{N}_p) - I(\\mathcal{N}_q)|^2}{h^2} \\Big). ]</p><p>NLM is widely used in MRI; parameters should account for non-Gaussian, spatially varying noise.</p><h3 id="pca-based-denoising" tabindex="-1">PCA-Based Denoising <a class="header-anchor" href="#pca-based-denoising" aria-label="Permalink to “PCA-Based Denoising”">​</a></h3><p>Treat patches or voxels as high-dimensional vectors and perform principal component analysis (PCA). Suppress components dominated by noise (low-variance) and reconstruct patches from retained components. PCA denoising is effective for multi-echo, time-series (fMRI), or multi-coil data; model design must consider non-stationary noise and complex-valued signals.</p><h2 id="minimal-k-space-processing-pipeline" tabindex="-1">Minimal k-Space Processing Pipeline <a class="header-anchor" href="#minimal-k-space-processing-pipeline" aria-label="Permalink to “Minimal k-Space Processing Pipeline”">​</a></h2>',26)),c(n,{id:"mermaid-9mgzttfgn",code:`graph LR
    A[Object] -->|Excitation| B[Signal Acquisition\\nFreq + Phase Encoding]
    B --> C[k-Space Matrix\\n s(kx, ky)]
    C --> D[Preprocessing\\n Filtering / Zero-fill / Regridding]
    D --> E[Inverse FT\\n Image Space]
    E --> F[Image-Domain Processing\\n Denoise / Correct / Segment]`}),e[1]||(e[1]=i("p",null,"Key steps:",-1)),e[2]||(e[2]=i("ul",null,[i("li",null,"Acquisition: gradient encoding and collecting k-space lines per phase-encode step."),i("li",null,"Preprocessing: zero-filling, windowing, regridding (for non-Cartesian), correcting gradient delays/nonlinearity, coil sensitivity preparation."),i("li",null,"Inverse FT: FFT/NUFFT to image space, followed by coil combination."),i("li",null,"Image-domain operations: denoising, bias-field correction, segmentation/detection.")],-1)),e[3]||(e[3]=i("p",null,"Next:",-1)),e[4]||(e[4]=i("ul",null,[i("li",null,[a("Reconstruction principles: Chapter 3 ("),i("code",null,"/en/guide/ch03/01-analytic-recon"),a(")")])],-1))])}const b=r(p,[["render",d]]);export{y as __pageData,b as default};
